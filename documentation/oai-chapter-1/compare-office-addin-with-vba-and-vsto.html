<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
	<meta name="keywords" content="Office 2013 App,Office 扩展应用, Office 插件开发, 跨Office 平台应用, 
									simpeng, simpeng.net, Office Add-In, App for Office" />
    <meta name="description" content="Office 2013 App,Office 扩展应用, Office 插件开发, 跨Office 平台应用, 
									simpeng, simpeng.net, Office Add-In, App for Office" />
    <meta name="author" content="">

    <title>与VBA、VSTO的区别 - Office 扩展应用文档</title>

    <!-- Bootstrap core CSS -->
    <link href="http://ajax.aspnetcdn.com/ajax/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet">
    <link href="../assets/css/dashboard.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="../assets/js/ie-emulation-modes-warning.js"></script>
  </head>

  <body>
  
	<nav class="navbar navbar-inverse navbar-fixed-top">
	  <div class="container-fluid">
        <div class="navbar-header">
          <button class="navbar-toggle collapsed" aria-expanded="false" aria-controls="navbar" type="button" data-toggle="collapse" data-target="#left-nav-sidebar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">开发 Office 平台上的扩展应用</a>
        </div>
      </div>
    </nav>

	<div class="container-fluid">
      <div class="row">
        <div id="left-nav-sidebar" class="col-sm-12 col-xs-12 col-md-2 sidebar collapse">
          <ul class="nav nav-sidebar">
			<li id="oai-chapter-1" class="active oai-chapter-row"><a>什么是 Office 扩展应用</a></li>
<li id="oai-chapter-1-section-1" class="oai-chapter-1-section oai-chapter-section-row activedSectionRow " style="display:none"><a href="../oai-chapter-1/office-addin-introduction.html?s=oai-chapter-1-section-1">扩展应用简介</a></li>
<li id="oai-chapter-1-section-2" class="oai-chapter-1-section oai-chapter-section-row  " style="display:none"><a href="../oai-chapter-1/start-with-hello-world.html?s=oai-chapter-1-section-2">Hello World 应用</a></li>
<li id="oai-chapter-1-section-3" class="oai-chapter-1-section oai-chapter-section-row  " style="display:none"><a href="../oai-chapter-1/office-addin-types-and-current-platoform-supporting.html?s=oai-chapter-1-section-3">扩展应用类型及平台支持</a></li>
<li id="oai-chapter-1-section-4" class="oai-chapter-1-section oai-chapter-section-row  " style="display:none"><a href="../oai-chapter-1/compare-office-addin-with-vba-and-vsto.html?s=oai-chapter-1-section-4">与VBA、VSTO的区别</a></li>
<li id="oai-chapter-1-section-5" class="oai-chapter-1-section oai-chapter-section-row  " style="display:none"><a href="../oai-chapter-1/office-addin-data-sources.html?s=oai-chapter-1-section-5">Office 扩展应用的数据源</a></li>
<li id="oai-chapter-2" class="active oai-chapter-row"><a>Office 文档操作 API</a></li>
<li id="oai-chapter-2-section-1" class="oai-chapter-2-section oai-chapter-section-row activedSectionRow " style="display:none"><a href="../oai-chapter-2/word-addin-API.html?s=oai-chapter-2-section-1">Word 文档 API</a></li>
<li id="oai-chapter-2-section-2" class="oai-chapter-2-section oai-chapter-section-row  " style="display:none"><a href="../oai-chapter-2/excel-addin-API.html?s=oai-chapter-2-section-2">Excel 文档 API</a></li>
<li id="oai-chapter-2-section-3" class="oai-chapter-2-section oai-chapter-section-row  " style="display:none"><a href="../oai-chapter-2/powerpoint-addin-API.html?s=oai-chapter-2-section-3">PowerPoint 文档 API</a></li>
<li id="oai-chapter-2-section-4" class="oai-chapter-2-section oai-chapter-section-row  " style="display:none"><a href="../oai-chapter-2/outlook-addin-API.html?s=oai-chapter-2-section-4">邮件文档 API</a></li>
<li id="oai-chapter-2-section-5" class="oai-chapter-2-section oai-chapter-section-row  " style="display:none"><a href="../oai-chapter-2/access-addin-API.html?s=oai-chapter-2-section-5">Access 文档 API</a></li>
<li id="oai-chapter-2-section-6" class="oai-chapter-2-section oai-chapter-section-row  " style="display:none"><a href="../oai-chapter-2/project-addin-API.html?s=oai-chapter-2-section-6">Project 文档 API</a></li>
<li id="oai-chapter-3" class="active oai-chapter-row"><a>Office 365 API</a></li>
<li id="oai-chapter-3-section-1" class="oai-chapter-3-section oai-chapter-section-row activedSectionRow " style="display:none"><a href="../oai-chapter-3/mail-calender-contacts-on-exchange-online-rest-API.html?s=oai-chapter-3-section-1">访问 Exchange Online 的邮件、日历、联系人</a></li>
<li id="oai-chapter-3-section-2" class="oai-chapter-3-section oai-chapter-section-row  " style="display:none"><a href="../oai-chapter-3/file-and-folder-on-spo-and-onedriveforbusiness-API.html?s=oai-chapter-3-section-2">访问 SharePoint Online 和 OneDrive 商业版的目录和文件</a></li>
<li id="oai-chapter-3-section-3" class="oai-chapter-3-section oai-chapter-section-row  " style="display:none"><a href="../oai-chapter-3/user-and-group-on-azure-ad-API.html?s=oai-chapter-3-section-3">访问 Azure AD 用户和用户组</a></li>
<li id="oai-chapter-3-section-4" class="oai-chapter-3-section oai-chapter-section-row  " style="display:none"><a href="../oai-chapter-3/outlook-addin-API.html?s=oai-chapter-3-section-4">Office graph</a></li>

          </ul>
        </div>
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
		  <h4 style="color: blue; display:none">您所在的位置：什么是 Office 扩展应用》与VBA、VSTO的区别</h4>
		  <h1 class="page-header">与VBA、VSTO的区别</h1>
		  <h3 class="sub-header">VBA（Visual Basic for Applications）</h3>
<p>
						<p>Visual Basic for Applications（简称VBA）是一种宏语言，由微软公司开发，可用来实现在微软桌面应用程序环境下的通用自动化(OLE)任务。
						主要能用来扩展 Windows 的应用程序功能，特别是针对 Microsoft Office 软件。
						微软在 1994 年发行的 Excel 5.0 版本中，即具备了 VBA 的宏功能。
						VBA 使可编程应用软件得到完美的实现，它作为一种通用的宏语言可被所有的微软可编程应用软件所共享。
						在Office 2000 中，宏语言 VBA 适用于所有应用程序，包括 Word 、 Excel、PowerPoint、Access、Outlook 以及Project。
						</p>
						<p>
						VBA 是基于 Visual Basic for Windows 发展而来的，它与传统的宏语言不同，传统的宏语言不具有高级语言的特征，没有面向对象的程序设计概念和方法。
						而VBA 提供了面向对象的程序设计方法，提供了相当完整的程序设计语言。
						VBA 易于学习掌握，可以使用宏记录器记录用户的各种操作并将其转换为VBA 程序代码。
						这样用户可以容易地将日常工作转换为VBA 程序代码，使工作自动化。
						因此，对于在工作中需要经常使用Office 套装软件的用户，学用VBA 有助于使工作自动化，提高工作效率。
						另外，由于VBA 可以直接应用Office 套装软件的各项强大功能，所以对于程序设计人员的程序设计和开发更加方便快捷。
						</p>
						<p>由于微软 Office 软件的普及，用户可在 Word、Excel、Access、Powerpoint 中利用 VBA 编写自定义的代码来扩展 Office 软件的功能，从而提升效率。
						例如：通过一段VBA代码，可以实现画面的切换或者实现复杂逻辑的统计等。
						Office 取得巨大成功的一个重要原因就是 VBA，使用VBA可以完成很多事情，基于Excel、Word的VBA小程序不计其数。
						VBA 的语言入门门槛较低，而这些用户利用 VBA 解决的正式工作中关键问题。因此，VBA 程序大多作为部门内部或个人使用的小工具。
						</p>
						</p>
<h3 class="sub-header">VSTO（Visual Studio Tools for Office）</h3>
<p>
						<p>
						VSTO（Visual Studio Tools for Office ）是 VBA 的替代，使开发 Office 应用程序更加简单。
						另外，使用 VSTO 来开发 Office 应用程序的开发者可以利用 Visual Studio 开发环境中的强大功能和 CLR 提供的内存管理，垃圾回收等功能，大大地提高开发效率。
						</p>
						<p>
						VSTO 是一套用于创建自定义Office应用程序的Visual Studio工具包。
						VSTO 使开发者可以用 Visual Basic 或者 Visual C# 扩展 Office 应用程序(例如Word、Excel、InfoPath和Outlook)的功能，
						同时允许开发者直接利用Visual Studio开发环境来创建自定义程序。无论你是创建简单的数据录入应用程序还是复杂的企业解决方案，VSTO都使之变得容易。
						VSTO还提供了增强的Office对象，开发者提供了更大的文档操作支持。例如，可以直接在Excel电子表格或者Word文档上添加.NET控件，也被称为 Windows Forms 控件，然后把数据直接绑定到控件上。
						</p>
						<p>
						利用 VSTO 开发时，开发者在 Visual Studio 中利用各种模板创建项目，如下图所示。其中有针对Excel的外接程序(Add-Ins)，也有针对 Outlook 的外接程序。
						<hr class="featurette-divider">
						
						<div class="row featurette">
							<div class="col-md-12">
							  <img class="featurette-image img-responsive center-block" src="../assets/images/vsto-office-addins-templates.png" alt="Generic placeholder image">
							</div>
						</div>
						
						<hr class="featurette-divider">
						<p>
						使用 VSTO 生成外接程序时，您会创建一个由 Microsoft Office 应用程序加载的托管代码程序集（managed code assembly）。 
						加载了程序集之后，外接程序可以响应在 Office 应用程序中引发的事件（例如，用户单击菜单项时引发的事件）。 
						外接程序也可以调入对象模型以便实现扩展应用程序的目的，并且它可以使用 .NET Framework 中的任何类。
						托管代码程序集通过 Office 应用程序的主互操作程序集（PIA）与 Office 应用程序进行交互（基于 COM 的对象模型）。
						</p>
						<p>
						创建新的 Office 项目时，Visual Studio 会添加对生成该项目所需的 PIA 的引用，例如下述代码中的 Microsoft.Office.Interop.Excel.dll。 在某些情况下，你可能需要添加对其他 PIA 的引用（例如，如果你希望在 Microsoft Office Excel 项目中使用 Microsoft Office Word 的功能）。
						MSDN 中列出了可用于 Office 2013 和 Office 2010 的 <a href="https://msdn.microsoft.com/zh-cn/library/15s06t57.aspx" target="_blank">主互操作程序集</a>。
						
						<p>
						<pre>
						using System;
						using System.Collections.Generic;
						using System.Linq;
						using System.Text;
						using System.Xml.Linq;
						// Microsoft Excel 对象库
						using Excel = Microsoft.Office.Interop.Excel;
						using Office = Microsoft.Office.Core;
						using Microsoft.Office.Tools.Excel;

						namespace ExcelAddIn1
						{
							public partial class ThisAddIn
							{
								private void ThisAddIn_Startup(object sender, System.EventArgs e)
								{
								}

								private void ThisAddIn_Shutdown(object sender, System.EventArgs e)
								{
								}

								#region VSTO generated code

								/// <summary>
								/// Required method for Designer support - do not modify
								/// the contents of this method with the code editor.
								/// </summary>
								private void InternalStartup()
								{
									this.Startup += new System.EventHandler(ThisAddIn_Startup);
									this.Shutdown += new System.EventHandler(ThisAddIn_Shutdown);
								}
								
								#endregion
							}
						}

						</pre>
						</p>
						</p>
<h3 class="sub-header">Office 扩展应用（Office Add-Ins，Office Apps， Apps for Office）</h3>
<p>

						</p>
<h3 class="sub-header">相关链接</h3>
<p>
						<table class="table table-striped">
						  <tbody>
							<tr>
							  <td><a href="http://baike.baidu.com/link?url=6XT-4wjK0jqOcyG2GK769PhcP6vhZufcWpXm9bmP_xypjgexxnoNQNzv61QfljOXObH_pFCmPhYT_LlThYbSZKjF_Pcwd4uu6RoeNq_o97O" target="_blank">VBA（Visual Basic宏语言）- 百度百科</a></td>
							</tr>
							<tr>
							  <td><a href="http://baike.baidu.com/link?url=9_iy3UIHwVXad5l4hNICptJHJC4c5F4NxKKn0uKpyF-po7SCH7nJ0BxYkER3wnQP04kHnAoaGxBLSXIHibIH7_" target="_blank">VSTO - 百度百科</a></td>
							</tr>
							<tr>
							  <td><a href="https://msdn.microsoft.com/zh-cn/library/bb386298.aspx#HowAddinsWork" target="_blank">应用程序级外接程序的体系结构</a></td>
							</tr>
							<tr>
							  <td><a href="https://msdn.microsoft.com/zh-cn/library/15s06t57.aspx" target="_blank">Office 主互操作程序集</a></td>
							</tr>
							<tr>
							  <td><a href="" target="_blank"></a></td>
							</tr>
						  </tbody>
						</table>
						</p>

        </div>
      </div>
    </div>
	
 
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.11.2.min.js"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/bootstrap/3.3.4/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../assets/js/ie10-viewport-bug-workaround.js"></script>
    <script src="../assets/js/oai.js"></script>
  </body>
</html>
